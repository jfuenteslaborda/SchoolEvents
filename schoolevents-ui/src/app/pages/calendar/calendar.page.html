<app-header-calendar></app-header-calendar>

<ion-content [fullscreen]="true">

    <div style="margin-top: 10%" class="carousel-header">
        <h2>CALENDARIO</h2>
    </div>

    <div class="card">
        <app-calendar-component
                (fechaConfirmadaEvent)="onFechaSeleccionada($event)">
        </app-calendar-component>
    </div>

    <div class="carousel-header">
        <h2>Eventos filtrado por día</h2>
    </div>
    <div class="card carousel-container">
        <app-carousel [fechaSeleccionada]="fechaSeleccionada"></app-carousel>
    </div>

    <div class="carousel-header">
        <h2>Eventos en 2 semanas</h2>
    </div>
    <div style="margin-bottom: 25%" class="card carousel-container">
        <app-carousel-unfiltered></app-carousel-unfiltered>
    </div>

    <div *ngIf="isAdmin"
         style="position: fixed; bottom: 60px; left: 0; right: 0; padding: 0 16px; z-index: 10;">
        <ion-button expand="block" (click)="openEventModal()">
            Crear Nuevo Evento
        </ion-button>
    </div>

</ion-content>

<ion-modal [isOpen]="showEventModal" (didDismiss)="closeEventModal()">
    <ng-template>

        <ion-header>
            <ion-toolbar>
                <ion-title>Nuevo Evento</ion-title>
                <ion-buttons slot="end">
                    <ion-button (click)="closeEventModal()">Cerrar</ion-button>
                </ion-buttons>
            </ion-toolbar>
        </ion-header>

        <ion-content class="ion-padding">
            <form [formGroup]="eventForm" (ngSubmit)="saveEvent()">

                <ion-item>
                    <ion-label position="floating">Título</ion-label>
                    <ion-input formControlName="title"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-label position="floating">Fecha</ion-label>
                    <ion-input type="date" formControlName="date"></ion-input>
                </ion-item>

                <ion-button expand="block" fill="outline" (click)="handleImageUpload()">
                    Seleccionar imagen
                </ion-button>

                <img *ngIf="imagePreviewSrc"
                     [src]="imagePreviewSrc"
                     style="width:100%; height:180px; object-fit:cover; margin-top:10px; border-radius:10px">

                <ion-item>
                    <ion-label position="floating">Capacidad</ion-label>
                    <ion-input type="number" formControlName="capacity"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-label>¿Requiere pago?</ion-label>
                    <ion-toggle slot="end" formControlName="need_payment"></ion-toggle>
                </ion-item>

                <ion-item *ngIf="eventForm.get('need_payment')?.value">
                    <ion-label position="floating">Precio</ion-label>
                    <ion-input type="number" formControlName="price"></ion-input>
                </ion-item>

                <ion-item>
                    <ion-label position="floating">Descripción</ion-label>
                    <ion-textarea formControlName="description"></ion-textarea>
                </ion-item>

                <ion-button expand="block" type="submit" [disabled]="eventForm.invalid">
                    Guardar Evento
                </ion-button>

            </form>
        </ion-content>
    </ng-template>
</ion-modal>

<app-footer-menu></app-footer-menu>
